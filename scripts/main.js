"use strict";var callbackScript=null,callbackCounter=0,processData;!function(){function e(e,t){function n(a){document.removeEventListener("DOMContentLoaded",n),e.call(t||window,a)}function a(n){"complete"===document.readyState&&(document.detachEvent("onreadystatechange",a),e.call(t||window,n))}document.addEventListener&&document.addEventListener("DOMContentLoaded",n)||document.attachEvent&&document.attachEvent("onreadystatechange",a)}function t(){function e(e){e.preventDefault();var n=document.getElementById("searchField").value;h.innerHTML="",null!=n&&/\S/.test(n)?(document.getElementById("searchField").blur(),t(n)):h.innerHTML="Input can not be blank or only white spaces."}function t(e){var a=arguments.length<=1||void 0===arguments[1]?0:arguments[1],l=arguments.length<=2||void 0===arguments[2]?[]:arguments[2],i=arguments.length<=3||void 0===arguments[3]?0:arguments[3],s="https://api.twitch.tv/kraken/search/streams?q=",o=100,r=s+e+"&limit="+o+"&offset="+a+"&callback=processData&uniqueRequestId="+e+"_"+callbackCounter;callbackScript||(callbackScript=document.createElement("script"),callbackScript.type="text/javascript",callbackScript.id="callbackScript",callbackScript.src=r,callbackScript.async=!0,document.body.appendChild(callbackScript),processData=function(s){if(document.body.removeChild(callbackScript),callbackScript=null,d.classList.add("shown"),m.classList.add("hideThis"),u.classList.remove("shown"),0===s.streams.length){i=100,c(i),d.className="",console.log("DONE!");var r=l.sort(function(e,t){return t.viewers-e.viewers}),v=function(e){for(var t=1;t<e.length;)e[t-1]._id===e[t]._id?e.splice(t,1):t++;return e};r=v(r),r.length>0?(m.classList.remove("hideThis"),g.classList.remove("shown"),n(r)):g.classList.add("shown")}else{console.log("total ",i),console.log((i/s._total*100).toFixed(2)+"%");var h=100*(i/s._total).toFixed(2);c(h),l=l.concat(s.streams),callbackCounter++,t(e,a+o,l,i+s.streams.length)}})}function n(e){function t(e,n){var c=0,s="",o=document.getElementById("btn_next"),r=document.getElementById("btn_prev"),d=document.getElementById("streamList"),u=document.getElementById("pageNumber");o.onclick=function(e){e.preventDefault(),l<a(n)&&(l++,t(l,n))},r.onclick=function(e){e.preventDefault(),l>1&&(l--,t(l,n))},1>e&&(e=1),e>a(n)&&(e=a(n)),d.innerHTML="",c=e*i<n.length?e*i:n.length;for(var m=(e-1)*i;c>m;m++){var v=n[m].channel,h=v.display_name,g=v.url,p=v.game,b=v.status,y=n[m].viewers,f=n[m].preview.large,E='<a href="'+g+'" target="_blank"><h3 class="streamName">'+h+"</h3></a>",k='<a href="'+g+'" target="_blank"><img src="'+f+'" alt="" /></a>',L='<span class="viewCount">'+y+" Viewers</span>",w='<h5 class="gameName">'+p+" - "+L+"</h5>",I='<p class="description">'+b+"</p>";s+='<li class="stream"><div class="row"><div class="col-sm-4 col-lg-5">'+k+'</div><div class="col-sm-8 col-lg-7">'+E+w+I+"</div></div></li>"}d.innerHTML=s,u.innerHTML=e+" / "+a(n),1===e?r.style.visibility="hidden":r.style.visibility="visible",e===a(n)?o.style.visibility="hidden":o.style.visibility="visible"}u.classList.add("shown");var n="Total: "+e.length;v.innerHTML=n,t(1,e)}function a(e){return Math.ceil(e.length/i)}function c(e){r.style.width=e+"%"}var l=1,i=5,s=document.getElementById("searchTwitch"),o=document.querySelector("#searchForm"),r=document.getElementById("backColor"),d=document.getElementById("loading"),u=document.getElementById("pagination"),m=document.getElementById("content"),v=document.getElementById("total"),h=document.getElementById("error"),g=document.getElementById("nothingFound");s.addEventListener("touchend",e,!1),s.addEventListener("click",e,!1),o.addEventListener("submit",e,!1)}e(t)}();